<div class="modal" [class.show]="isVisible">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ edit ? 'Editar Usuario' : 'Agregar Usuario' }}</h5>
        <button type="button" class="close" (click)="onClose()">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="name">Nombre</label>
                <input type="text" id="name" class="form-control" formControlName="name">
                <div *ngIf="form.get('name')?.invalid && form.get('name')?.touched" class="error-message">
                  El nombre es obligatorio
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="lastname">Apellido</label>
                <input type="text" id="lastname" class="form-control" formControlName="lastname">
                <div *ngIf="form.get('lastname')?.invalid && form.get('lastname')?.touched" class="error-message">
                  El apellido es obligatorio
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" class="form-control" formControlName="email">
                <div *ngIf="form.get('email')?.errors?.['required'] && form.get('email')?.touched" class="error-message">
                  El email es obligatorio
                </div>
                <div *ngIf="form.get('email')?.errors?.['email'] && form.get('email')?.touched" class="error-message">
                  El formato del email es inválido
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="phone">Teléfono</label>
                <input type="text" id="phone" class="form-control" formControlName="phone">
                <div *ngIf="form.get('phone')?.invalid && form.get('phone')?.touched" class="error-message">
                  El teléfono es obligatorio
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="address">Dirección</label>
                <input type="text" id="address" class="form-control" formControlName="address">
                <div *ngIf="form.get('address')?.invalid && form.get('address')?.touched" class="error-message">
                  La dirección es obligatoria
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="dni">DNI</label>
                <input type="text" id="dni" class="form-control" formControlName="dni">
                <div *ngIf="form.get('dni')?.invalid && form.get('dni')?.touched" class="error-message">
                  El DNI es obligatorio
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="password" id="password" class="form-control" formControlName="password">
                <div *ngIf="form.get('password')?.invalid && form.get('password')?.touched && !edit" class="error-message">
                  La contraseña es obligatoria
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="role">Rol</label>
                <select id="role" class="form-control" formControlName="role">
                  <option value="">Seleccionar rol</option>
                  <option value="1">Administrador</option>
                  <option value="2">Bibliotecario</option>
                  <option value="3">Usuario</option>
                </select>
                <div *ngIf="form.get('role')?.invalid && form.get('role')?.touched" class="error-message">
                  El rol es obligatorio
                </div>
              </div>
            </div>
          </div>

          <div class="form-group" *ngIf="edit">
            <label for="state">Estado</label>
            <select id="state" class="form-control" formControlName="state">
              <option value="ACTIVE">Activo</option>
              <option value="INACTIVE">Inactivo</option>
            </select>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="onClose()">Cancelar</button>
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid">
              {{ edit ? 'Actualizar' : 'Guardar' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
